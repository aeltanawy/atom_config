!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-array")):"function"==typeof define&&define.amd?define(["exports","d3-array"],t):t((n=n||self).vega={},n.d3)}(this,function(n,t){"use strict";function r(n,t){var r,a=[],o=n.length,u=-1;if(null==t)for(;++u<o;)isNaN(r=e(n[u]))||a.push(r);else for(;++u<o;)isNaN(r=e(t(n[u],u,n)))||a.push(r);return a}function e(n){return null===n?NaN:+n}function a(n,e){var a=r(n,e);return[t.quantile(a.sort(t.ascending),.25),t.quantile(a,.5),t.quantile(a,.75)]}function o(t,r){var e,a,o=NaN,u={mean:function(n){return arguments.length?(e=n||0,o=NaN,u):e},stdev:function(n){return arguments.length?(a=null==n?1:n,o=NaN,u):a},sample:function(){var t,r,u=0,i=0;if(o==o)return u=o,o=NaN,u;do{t=(u=2*n.random()-1)*u+(i=2*n.random()-1)*i}while(0===t||t>1);return r=Math.sqrt(-2*Math.log(t)/t),o=e+i*r*a,e+u*r*a},pdf:function(n){var t=Math.exp(Math.pow(n-e,2)/(-2*Math.pow(a,2)));return 1/(a*Math.sqrt(2*Math.PI))*t},cdf:function(n){var t,r=(n-e)/a,o=Math.abs(r);if(o>37)t=0;else{var u=Math.exp(-o*o/2);o<7.07106781186547?(t=u*((((((.0352624965998911*o+.700383064443688)*o+6.37396220353165)*o+33.912866078383)*o+112.079291497871)*o+221.213596169931)*o+220.206867912376),t/=((((((.0883883476483184*o+1.75566716318264)*o+16.064177579207)*o+86.7807322029461)*o+296.564248779674)*o+637.333633378831)*o+793.826512519948)*o+440.413735824752):t=u/(o+1/(o+2/(o+3/(o+4/(o+.65)))))/2.506628274631}return r>0?1-t:t},icdf:function(n){if(n<=0||n>=1)return NaN;var t=2*n-1,r=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),o=2/(Math.PI*r)+Math.log(1-Math.pow(t,2))/2,u=Math.log(1-t*t)/r,i=(t>0?1:-1)*Math.sqrt(Math.sqrt(o*o-u)-o);return e+a*Math.SQRT2*i}};return u.mean(t).stdev(r)}n.random=Math.random,n.bin=function(n){var t,r,e,a,o,u,i,f,c=n.maxbins||20,d=n.base||10,h=Math.log(d),l=n.divide||[5,2],s=n.extent[0],p=n.extent[1],M=p-s||Math.abs(s)||1;if(n.step)t=n.step;else if(n.steps){for(o=M/c,u=0,i=n.steps.length;u<i&&n.steps[u]<o;++u);t=n.steps[Math.max(0,u-1)]}else{for(r=Math.ceil(Math.log(c)/h),e=n.minstep||0,t=Math.max(e,Math.pow(d,Math.round(Math.log(M)/h)-r));Math.ceil(M/t)>c;)t*=d;for(u=0,i=l.length;u<i;++u)(o=t/l[u])>=e&&M/o<=c&&(t=o)}return a=(o=Math.log(t))>=0?0:1+~~(-o/h),f=Math.pow(d,-a-1),(n.nice||void 0===n.nice)&&(s=s<(o=Math.floor(s/t+f)*t)?o-t:o,p=Math.ceil(p/t)*t),{start:s,stop:p===s?s+t:p,step:t}},n.bootstrapCI=function(e,a,o,u){if(!e.length)return[void 0,void 0];var i,f,c,d,h=r(e,u),l=h.length,s=a;for(c=0,d=Array(s);c<s;++c){for(i=0,f=0;f<l;++f)i+=h[~~(n.random()*l)];d[c]=i/l}return[t.quantile(d.sort(t.ascending),o/2),t.quantile(d,1-o/2)]},n.quartiles=a,n.setRandom=function(t){n.random=t},n.randomLCG=function(n){return function(){return(n=(1103515245*n+12345)%2147483647)/2147483647}},n.randomInteger=function(t,r){null==r&&(r=t,t=0);var e,a,o,u={};return u.min=function(n){return arguments.length?(o=a-(e=n||0),u):e},u.max=function(n){return arguments.length?(o=(a=n||0)-e,u):a},u.sample=function(){return e+Math.floor(o*n.random())},u.pdf=function(n){return n===Math.floor(n)&&n>=e&&n<a?1/o:0},u.cdf=function(n){var t=Math.floor(n);return t<e?0:t>=a?1:(t-e+1)/o},u.icdf=function(n){return n>=0&&n<=1?e-1+Math.floor(n*o):NaN},u.min(t).max(r)},n.randomKDE=function(r,e){var u=o(),i={},f=0;return i.data=function(n){return arguments.length?(r=n,f=n?n.length:0,i.bandwidth(e)):r},i.bandwidth=function(n){return arguments.length?(!(e=n)&&r&&(u=(o=r).length,f=a(o),c=(f[2]-f[0])/1.34,e=1.06*Math.min(Math.sqrt(t.variance(o)),c)*Math.pow(u,-.2)),i):e;var o,u,f,c},i.sample=function(){return r[~~(n.random()*f)]+e*u.sample()},i.pdf=function(n){for(var t=0,a=0;a<f;++a)t+=u.pdf((n-r[a])/e);return t/e/f},i.cdf=function(n){for(var t=0,a=0;a<f;++a)t+=u.cdf((n-r[a])/e);return t/f},i.icdf=function(){throw Error("KDE icdf not supported.")},i.data(r)},n.randomMixture=function(t,r){var e,a={},o=0;return a.weights=function(n){return arguments.length?(e=function(n){var t,r=[],e=0;for(t=0;t<o;++t)e+=r[t]=null==n[t]?1:+n[t];for(t=0;t<o;++t)r[t]/=e;return r}(r=n||[]),a):r},a.distributions=function(n){return arguments.length?(n?(o=n.length,t=n):(o=0,t=[]),a.weights(r)):t},a.sample=function(){for(var r=n.random(),a=t[o-1],u=e[0],i=0;i<o-1;u+=e[++i])if(r<u){a=t[i];break}return a.sample()},a.pdf=function(n){for(var r=0,a=0;a<o;++a)r+=e[a]*t[a].pdf(n);return r},a.cdf=function(n){for(var r=0,a=0;a<o;++a)r+=e[a]*t[a].cdf(n);return r},a.icdf=function(){throw Error("Mixture icdf not supported.")},a.distributions(t).weights(r)},n.randomNormal=o,n.randomUniform=function(t,r){null==r&&(r=null==t?1:t,t=0);var e,a,o,u={};return u.min=function(n){return arguments.length?(o=a-(e=n||0),u):e},u.max=function(n){return arguments.length?(o=(a=n||0)-e,u):a},u.sample=function(){return e+o*n.random()},u.pdf=function(n){return n>=e&&n<=a?1/o:0},u.cdf=function(n){return n<e?0:n>a?1:(n-e)/o},u.icdf=function(n){return n>=0&&n<=1?e+n*o:NaN},u.min(t).max(r)},Object.defineProperty(n,"__esModule",{value:!0})});